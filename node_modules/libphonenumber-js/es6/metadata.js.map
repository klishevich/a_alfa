{"version":3,"sources":["../source/metadata.js"],"names":["compare","V2","Metadata","metadata","countries","Error","v1","version","v2","country","undefined","_country","country_metadata","hasCountry","formats","map","Format","_","nationalPrefix","types","type","hasTypes","getType","Type","country_phone_code_to_countries","country_calling_codes","country_calling_code","countryCallingCodes","format","_format","nationalPrefixFormattingRule","nationalPrefixIsOptionalWhenFormatting","usesNationalPrefix","test","replace","possibleLengths"],"mappings":"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","file":"metadata.js","sourcesContent":["import compare from 'semver-compare'\r\n\r\n// Added \"possibleLengths\" and renamed\r\n// \"country_phone_code_to_countries\" to \"country_calling_codes\".\r\nconst V2 = '1.0.18'\r\n\r\nexport default class Metadata\r\n{\r\n\tconstructor(metadata)\r\n\t{\r\n\t\t// Metadata is required.\r\n\t\tif (!metadata || !metadata.countries)\r\n\t\t{\r\n\t\t\tthrow new Error('Metadata is required')\r\n\t\t}\r\n\r\n\t\tthis.metadata = metadata\r\n\r\n\t\tthis.v1 = !metadata.version\r\n\t\tthis.v2 = metadata.version // && compare(version, V3) === -1\r\n\t}\r\n\r\n\thasCountry(country)\r\n\t{\r\n\t\treturn this.metadata.countries[country] !== undefined\r\n\t}\r\n\r\n\tcountry(country)\r\n\t{\r\n\t\tif (!country)\r\n\t\t{\r\n\t\t\tthis._country = undefined\r\n\t\t\tthis.country_metadata = undefined\r\n\t\t\treturn this\r\n\t\t}\r\n\r\n\t\tif (!this.hasCountry(country))\r\n\t\t{\r\n\t\t\tthrow new Error(`Unknown country: ${country}`)\r\n\t\t}\r\n\r\n\t\tthis._country = country\r\n\t\tthis.country_metadata = this.metadata.countries[country]\r\n\t\treturn this\r\n\t}\r\n\r\n\tcountryCallingCode()\r\n\t{\r\n\t\treturn this.country_metadata[0]\r\n\t}\r\n\r\n\tnationalNumberPattern()\r\n\t{\r\n\t\treturn this.country_metadata[1]\r\n\t}\r\n\r\n\tpossibleLengths()\r\n\t{\r\n\t\tif (this.v1) return\r\n\t\treturn this.country_metadata[2]\r\n\t}\r\n\r\n\tformats()\r\n\t{\r\n\t\tconst formats = this.country_metadata[this.v1 ? 2 : 3] || []\r\n\t\treturn formats.map(_ => new Format(_, this))\r\n\t}\r\n\r\n\tnationalPrefix()\r\n\t{\r\n\t\treturn this.country_metadata[this.v1 ? 3 : 4]\r\n\t}\r\n\r\n\tnationalPrefixFormattingRule()\r\n\t{\r\n\t\treturn this.country_metadata[this.v1 ? 4 : 5]\r\n\t}\r\n\r\n\tnationalPrefixForParsing()\r\n\t{\r\n\t\t// If `national_prefix_for_parsing` is not set explicitly,\r\n\t\t// then infer it from `national_prefix` (if any)\r\n\t\treturn this.country_metadata[this.v1 ? 5 : 6] || this.nationalPrefix()\r\n\t}\r\n\r\n\tnationalPrefixTransformRule()\r\n\t{\r\n\t\treturn this.country_metadata[this.v1 ? 6 : 7]\r\n\t}\r\n\r\n\tnationalPrefixIsOptionalWhenFormatting()\r\n\t{\r\n\t\treturn this.country_metadata[this.v1 ? 7 : 8]\r\n\t}\r\n\r\n\tleadingDigits()\r\n\t{\r\n\t\treturn this.country_metadata[this.v1 ? 8 : 9]\r\n\t}\r\n\r\n\ttypes()\r\n\t{\r\n\t\treturn this.country_metadata[this.v1 ? 9 : 10]\r\n\t}\r\n\r\n\thasTypes()\r\n\t{\r\n\t\treturn this.types() !== undefined\r\n\t}\r\n\r\n\ttype(type)\r\n\t{\r\n\t\tif (this.hasTypes() && getType(this.types(), type))\r\n\t\t{\r\n\t\t\treturn new Type(getType(this.types(), type), this)\r\n\t\t}\r\n\t}\r\n\r\n\tcountryCallingCodes()\r\n\t{\r\n\t\tif (this.v1) return this.metadata.country_phone_code_to_countries\r\n\t\treturn this.metadata.country_calling_codes\r\n\t}\r\n\r\n\t// Formatting information for regions which share\r\n\t// a country calling code is contained by only one region\r\n\t// for performance reasons. For example, for NANPA region\r\n\t// (\"North American Numbering Plan Administration\",\r\n\t//  which includes USA, Canada, Cayman Islands, Bahamas, etc)\r\n\t// it will be contained in the metadata for `US`.\r\n\t//\r\n\t// `country_calling_code` is always valid.\r\n\t// But the actual country may not necessarily be part of the metadata.\r\n\t//\r\n\tchooseCountryByCountryCallingCode(country_calling_code)\r\n\t{\r\n\t\tconst country = this.countryCallingCodes()[country_calling_code][0]\r\n\r\n\t\t// Do not want to test this case.\r\n\t\t// (custom metadata, not all countries).\r\n\t\t/* istanbul ignore else */\r\n\t\tif (this.hasCountry(country))\r\n\t\t{\r\n\t\t\tthis.country(country)\r\n\t\t}\r\n\t}\r\n\r\n\tselectedCountry()\r\n\t{\r\n\t\treturn this._country\r\n\t}\r\n}\r\n\r\nclass Format\r\n{\r\n\tconstructor(format, metadata)\r\n\t{\r\n\t\tthis._format = format\r\n\t\tthis.metadata = metadata\r\n\t}\r\n\r\n\tpattern()\r\n\t{\r\n\t\treturn this._format[0]\r\n\t}\r\n\r\n\tformat()\r\n\t{\r\n\t\treturn this._format[1]\r\n\t}\r\n\r\n\tleadingDigitsPatterns()\r\n\t{\r\n\t\treturn this._format[2] || []\r\n\t}\r\n\r\n\tnationalPrefixFormattingRule()\r\n\t{\r\n\t\treturn this._format[3] || this.metadata.nationalPrefixFormattingRule()\r\n\t}\r\n\r\n\tnationalPrefixIsOptionalWhenFormatting()\r\n\t{\r\n\t\treturn this._format[4] || this.metadata.nationalPrefixIsOptionalWhenFormatting()\r\n\t}\r\n\r\n\tnationalPrefixIsMandatoryWhenFormatting()\r\n\t{\r\n\t\t// National prefix is omitted if there's no national prefix formatting rule\r\n\t\t// set for this country, or when the national prefix formatting rule\r\n\t\t// contains no national prefix itself, or when this rule is set but\r\n\t\t// national prefix is optional for this phone number format\r\n\t\t// (and it is not enforced explicitly)\r\n\t\treturn this.nationalPrefixFormattingRule() &&\r\n\t\t\t// Check that national prefix formatting rule is not a dummy one.\r\n\t\t\t// Check that national prefix formatting rule actually has national prefix digit(s).\r\n\t\t\tthis.usesNationalPrefix() &&\r\n\t\t\t// Or maybe national prefix is optional for this format\r\n\t\t\t!this.nationalPrefixIsOptionalWhenFormatting()\r\n\t}\r\n\r\n\t// Checks whether national prefix formatting rule contains national prefix\r\n\tusesNationalPrefix()\r\n\t{\r\n\t\t// Check that national prefix formatting rule is not a dummy one\r\n\t\treturn this.nationalPrefixFormattingRule() !== '$1' &&\r\n\t\t\t// Check that national prefix formatting rule actually has national prefix digit(s)\r\n\t\t\t/\\d/.test(this.nationalPrefixFormattingRule().replace('$1', ''))\r\n\t}\r\n\r\n\tinternationalFormat()\r\n\t{\r\n\t\treturn this._format[5] || this.format()\r\n\t}\r\n}\r\n\r\nclass Type\r\n{\r\n\tconstructor(type, metadata)\r\n\t{\r\n\t\tthis.type = type\r\n\t\tthis.metadata = metadata\r\n\t}\r\n\r\n\tpattern()\r\n\t{\r\n\t\tif (this.metadata.v1) return this.type\r\n\t\treturn this.type[0]\r\n\t}\r\n\r\n\tpossibleLengths()\r\n\t{\r\n\t\tif (this.metadata.v1) return\r\n\t\treturn this.type[1] || this.metadata.possibleLengths()\r\n\t}\r\n}\r\n\r\nfunction getType(types, type)\r\n{\r\n\tswitch (type)\r\n\t{\r\n\t\tcase 'FIXED_LINE':\r\n\t\t\treturn types[0]\r\n\t\tcase 'MOBILE':\r\n\t\t\treturn types[1]\r\n\t\tcase 'TOLL_FREE':\r\n\t\t\treturn types[2]\r\n\t\tcase 'PREMIUM_RATE':\r\n\t\t\treturn types[3]\r\n\t\tcase 'PERSONAL_NUMBER':\r\n\t\t\treturn types[4]\r\n\t\tcase 'VOICEMAIL':\r\n\t\t\treturn types[5]\r\n\t\tcase 'UAN':\r\n\t\t\treturn types[6]\r\n\t\tcase 'PAGER':\r\n\t\t\treturn types[7]\r\n\t\tcase 'VOIP':\r\n\t\t\treturn types[8]\r\n\t\tcase 'SHARED_COST':\r\n\t\t\treturn types[9]\r\n\t}\r\n}"]}